"""
backend_extractor.py（ダミー版）

このファイルは「PDFからテキストを抽出する部分」を担当します。
ただし、まだ本物の処理は作らず、
「ダミー（仮）データを返すだけ」の状態にしています。

目的：
- とりあえず main.py 全体の流れを作りたい
- PDF解析の中身は後でゆっくり実装したい
- チーム全員がプログラムの動き方を理解しやすくする

実際に PDF を読み取る処理は、後で unstructured や pypdf を使って追加します。
"""

from core_types import DocumentMeta, Chunk


def extract_from_pdf(file_path: str):
    """
    本物の PDF 処理はまだ実装していないので、
    “PDF を読んだことにするダミーのデータ” を返します。

    戻り値：
      - DocumentMeta（文書全体のメタ情報）
      - list[Chunk]（チャンク化されたテキスト）
    """

    # ---------------------------------------------------------
    # ① 文書のメタ情報を（とりあえず仮で）作る
    # ---------------------------------------------------------
    doc_meta = DocumentMeta(
        original_filename=file_path.split("/")[-1],  # 最後の部分だけ抜き出す
        mime_type="application/pdf",
        page_count=3,                # ダミー（3ページあったことにする）
        tags=["ダミー", "テスト"],     # とりあえず適当なタグ
    )

    # ---------------------------------------------------------
    # ② チャンクをダミーで3つ作る
    #
    # 本来は PDF を読み込んで段落ごとに分割するけれど、
    # MVPでは「とりあえずChunkが返ってくればOK」という設計にしています。
    # ---------------------------------------------------------
    chunks = [
        Chunk(
            chunk_index=0,
            text="これはダミーのチャンク1です。PDFの冒頭部分のテキストという設定です。",
            metadata={"page": 1, "heading": "概要"}
        ),
        Chunk(
            chunk_index=1,
            text="これはダミーのチャンク2です。PDF中盤のテキストという設定です。",
            metadata={"page": 2, "heading": "詳細情報"}
        ),
        Chunk(
            chunk_index=2,
            text="これはダミーのチャンク3です。PDF後半のテキストという設定です。",
            metadata={"page": 3, "heading": "まとめ"}
        ),
    ]

    # ---------------------------------------------------------
    # ③ main.py に返す
    # ---------------------------------------------------------
    return doc_meta, chunks
